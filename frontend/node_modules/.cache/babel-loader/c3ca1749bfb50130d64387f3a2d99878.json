{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJECTS\\\\ltbt-podcast\\\\frontend\\\\src\\\\components\\\\ProductPage.jsx\",\n    _s = $RefreshSig$();\n\nimport \"../styles/ProductPage.scss\";\nimport { productData } from \"../data/data\";\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useContext, useEffect, useReducer } from \"react\";\nimport axios from \"axios\";\nimport { detailsProduct } from \"../actions/productActions\";\nimport LoadingBox from \"./LoadingBox\";\nimport MessageBox from \"./MessageBox\";\nimport { getError } from \"../utils\";\nimport { Store } from \"../Store\";\nimport Nav from \"./Nav\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_REQUEST\":\n      return { ...state,\n        loading: true\n      };\n\n    case \"FETCH_SUCCESS\":\n      return { ...state,\n        product: action.payload,\n        loading: false\n      };\n\n    case \"FETCH_FAIL\":\n      return { ...state,\n        loading: false,\n        error: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nfunction ProductPage(props) {\n  _s();\n\n  const navigate = useNavigate();\n  const params = useParams();\n  const {\n    slug\n  } = params;\n  const [{\n    loading,\n    error,\n    product\n  }, dispatch] = useReducer(reducer, {\n    product: [],\n    loading: true,\n    error: \"\"\n  });\n  useEffect(() => {\n    const fetchData = async () => {\n      dispatch({\n        type: \"FETCH_REQUEST\"\n      });\n\n      try {\n        const result = await axios.get(`/api/store/slug/${slug}`);\n        dispatch({\n          type: \"FETCH_SUCCESS\",\n          payload: result.data\n        });\n      } catch (err) {\n        dispatch({\n          type: \"FETCH_FAIL\",\n          payload: getError(err)\n        });\n      }\n    };\n\n    fetchData();\n  }, [slug]); //add to cart functionality\n\n  const {\n    state,\n    dispatch: ctxDispatch\n  } = useContext(Store);\n  const {\n    cart\n  } = state;\n\n  const addToCartHandler = async () => {\n    //find if product exists in the cart\n    const existItem = cart.cartItems.find(item => item._id === product._id); //if it exists, increase quantity by 1 or set it to 1\n\n    const quantity = existItem ? existItem.quantity + 1 : 1;\n    const {\n      data\n    } = await axios.get(`/api/store/${product._id}`); //check if there's enough product in stock\n\n    if (data.countInStock < quantity) {\n      window.alert(\"Sorry, product is out of stock.\");\n      return;\n    }\n\n    ctxDispatch({\n      type: \"CART_ADD_ITEM\",\n      payload: { ...product,\n        quantity\n      }\n    });\n    navigate(\"/cart\");\n  };\n\n  return loading ? /*#__PURE__*/_jsxDEV(LoadingBox, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this) : error ? /*#__PURE__*/_jsxDEV(MessageBox, {\n    variant: \"danger\",\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"single-product-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-name\",\n          children: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-descrption\",\n          children: product.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-price\",\n          children: [\"$ \", product.price]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), product.countInStock > 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"product-status\",\n          children: \"IN STOCK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"product-status\",\n          children: \"OUT OF STOCK\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this), product.countInStock > 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"product-button\",\n          onClick: addToCartHandler,\n          children: \"ADD TO CART\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"product-button-nostock\",\n          children: \"ADD TO CART\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: product.image,\n        alt: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProductPage, \"q5JnMdbdWE3Ch0TI02bsavljGc0=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c = ProductPage;\nexport default ProductPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"sources":["D:/PROJECTS/ltbt-podcast/frontend/src/components/ProductPage.jsx"],"names":["productData","useParams","Link","useNavigate","useSelector","useDispatch","useContext","useEffect","useReducer","axios","detailsProduct","LoadingBox","MessageBox","getError","Store","Nav","reducer","state","action","type","loading","product","payload","error","ProductPage","props","navigate","params","slug","dispatch","fetchData","result","get","data","err","ctxDispatch","cart","addToCartHandler","existItem","cartItems","find","item","_id","quantity","countInStock","window","alert","name","description","price","image"],"mappings":"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","sourcesContent":["import \"../styles/ProductPage.scss\";\r\nimport { productData } from \"../data/data\";\r\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { useContext, useEffect, useReducer } from \"react\";\r\nimport axios from \"axios\";\r\nimport { detailsProduct } from \"../actions/productActions\";\r\nimport LoadingBox from \"./LoadingBox\";\r\nimport MessageBox from \"./MessageBox\";\r\nimport { getError } from \"../utils\";\r\nimport { Store } from \"../Store\";\r\nimport Nav from \"./Nav\";\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"FETCH_REQUEST\":\r\n      return { ...state, loading: true };\r\n    case \"FETCH_SUCCESS\":\r\n      return { ...state, product: action.payload, loading: false };\r\n    case \"FETCH_FAIL\":\r\n      return { ...state, loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nfunction ProductPage(props) {\r\n  const navigate = useNavigate();\r\n  const params = useParams();\r\n  const { slug } = params;\r\n\r\n  const [{ loading, error, product }, dispatch] = useReducer(reducer, {\r\n    product: [],\r\n    loading: true,\r\n    error: \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      dispatch({ type: \"FETCH_REQUEST\" });\r\n      try {\r\n        const result = await axios.get(`/api/store/slug/${slug}`);\r\n        dispatch({ type: \"FETCH_SUCCESS\", payload: result.data });\r\n      } catch (err) {\r\n        dispatch({ type: \"FETCH_FAIL\", payload: getError(err) });\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [slug]);\r\n\r\n  //add to cart functionality\r\n  const { state, dispatch: ctxDispatch } = useContext(Store);\r\n  const { cart } = state;\r\n\r\n  const addToCartHandler = async () => {\r\n    //find if product exists in the cart\r\n    const existItem = cart.cartItems.find((item) => item._id === product._id);\r\n    //if it exists, increase quantity by 1 or set it to 1\r\n    const quantity = existItem ? existItem.quantity + 1 : 1;\r\n    const { data } = await axios.get(`/api/store/${product._id}`);\r\n    //check if there's enough product in stock\r\n    if (data.countInStock < quantity) {\r\n      window.alert(\"Sorry, product is out of stock.\");\r\n      return;\r\n    }\r\n\r\n    ctxDispatch({\r\n      type: \"CART_ADD_ITEM\",\r\n      payload: { ...product, quantity },\r\n    });\r\n    navigate(\"/cart\");\r\n  };\r\n\r\n  return loading ? (\r\n    <LoadingBox />\r\n  ) : error ? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n  ) : (\r\n    <div>\r\n      <Nav />\r\n      <div className=\"single-product-container\">\r\n        <div className=\"product-info\">\r\n          <div className=\"product-name\">{product.name}</div>\r\n          <div className=\"product-descrption\">{product.description}</div>\r\n          <div className=\"product-price\">$ {product.price}</div>\r\n          {product.countInStock > 0 ? (\r\n            <p className=\"product-status\">IN STOCK</p>\r\n          ) : (\r\n            <p className=\"product-status\">OUT OF STOCK</p>\r\n          )}\r\n          {product.countInStock > 0 ? (\r\n            <button className=\"product-button\" onClick={addToCartHandler}>\r\n              ADD TO CART\r\n            </button>\r\n          ) : (\r\n            <button className=\"product-button-nostock\">ADD TO CART</button>\r\n          )}\r\n        </div>\r\n        <img src={product.image} alt={product.name}></img>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProductPage;\r\n"]},"metadata":{},"sourceType":"module"}